{% extends 'base.html.twig' %}

{% block title "Tous les articles"%}


{% block body %}
	<div class="row justify-content-center">
		<div class="col-xs-12">
			<div class="title mx-auto align-items-center">
				<h1 class="text-center font-weight-bold">
					Mes réalisations
				</h1>
			</div>
			{% if app.user %}
				<div class="button new_post_btn">
					<a class="btn btn-primary" href="{{ path('post_new') }}">Nouvel article</a>
				</div>
			{% endif %}


			<section class="posts">
				<div class="row mx-0 justify-content-center">

					{% for post in posts %} 
					
						{% set order = 1 %}
						{% set mainPicture = null %}
						{% set defaultPicture = asset('img/default-image.png') %}
						{# loop in pictures to find picture with sort_order = 1 #}
						{% for picture in post.pictures %}
							{% if picture.sortOrder == 1 %}
								{% set mainPicture = picture %}
							{% endif %}
						{% endfor %}

						<div class="one_post col-xs-12 col-xl-4">
							<div class="card card-block">
								<a href="{{ path( 'post_show', { id: post.id } ) }}">
									<img class="card-img-top img-fluid" src="{{ '/img/' ~ mainPicture.name|default('../img/default-image.png') }}" alt="Une image de l'article ">
								</a>
								<div class="card-body">
									<h4 class="card-title">
										<a href="{{ path( 'post_show', { id: post.id } ) }}">{{post.title}}</a>
									</h4>
									<div class=" row">
										<div class="card-text col-8 mr-auto px-3  text-truncate">
											{{post.heading }}
										</div>
										{% if app.user %}
											<div class="buttons col-3 d-flex px-2 mr-3">
												<a href="{{ path('post_update', { id: post.id }) }}" class="p-1">
													<i class="fas fa-pencil-alt fa-lg mr-2"></i>
												</a>
												<a href="{{ path('post_desactivate', { id: post.id }) }}" onclick="return confirm('Êtes-vous certain de vouloir désactiver cet article ?')" class="p-1" data-delete>
													<i class="fas fa-trash-alt fa-lg"></i>
												</a>
											</div>
										{% endif %}
									</div>

								</div>
							</div>
						</div>
					{% endfor %}
				</div>
			</section>
		</div>
	</div>
{% endblock %}
